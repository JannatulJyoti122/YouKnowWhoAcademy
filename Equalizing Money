#include<bits/stdc++.h>
using namespace std;
int ct=0;
int sum=0;
void dfs(int node,vector<int>&visited,vector<int>grid[],int a[],int n){
    visited[node]=1;
    ct++;
    sum+=a[node];
    for(int i=0;i<grid[node].size();i++){
        if(visited[grid[node][i]]==0) dfs(grid[node][i],visited,grid,a,n);
    }
}
int main(){
    int tt;
    cin>>tt;
    int cs=0;
    while(tt--){
        int n,m;
        cin>>n>>m;
        int a[n+1];
        for(int i=1;i<=n;i++) cin>>a[i];
        vector<int>grid[n+1];
        for(int i=0;i<m;i++){
            int x,y;
            cin>>x>>y;
            grid[x].push_back(y);
            grid[y].push_back(x);
        }
        vector<int>visited(n+1,0);
        int ans=0;
        set<int>st;
        for(int i=1;i<=n;i++){
            if(visited[i]==0){
                ct=0;
                sum=0;
                dfs(i,visited,grid,a,n);
                if(ct>0){
                    if(sum%ct!=0){
                        ans++;
                        break;
                    }
                    else{
                        st.insert(sum/ct);
                    }
                }
            }
        }
        cout<<"Case "<<++cs<<": ";
        if(ans==0){
            if(st.size()==1) cout<<"Yes\n";
            else cout<<"No\n";
        }
        else cout<<"No\n";
    }
}
