#include<bits/stdc++.h>
using namespace std;
const int N=1e5+9;
int a[N];
int t[4*N];
void build(int n,int b,int e){
    if(b==e){
        t[n]=a[b];
        return;
    }
    int mid=(b+e)/2;
    int left=2*n;
    int right=left+1;
    build(left,b,mid);
    build(right,mid+1,e);
    t[n]=t[left]+t[right];
}
void update(int n,int b,int e,int ind,int val){
    if(b>ind||e<ind) return;
    if(b==e && b==ind){
        if(val==0) cout<<t[n]<<endl;
        if(val==0) t[n]=val;
        else t[n]+=val;
        return;
    }
    int mid=(b+e)/2;
    int left=2*n;
    int right=left+1;
    update(left,b,mid,ind,val);
    update(right,mid+1,e,ind,val);
    t[n]=t[left]+t[right];
}
int query(int n,int b,int e,int i,int j){
    if(j<b||e<i) return 0;
    if(i<=b&&e<=j){
        return t[n];
    }
    int mid=(b+e)/2;
    int left=2*n;
    int right=left+1;
    return(query(left,b,mid,i,j)+query(right,mid+1,e,i,j));
}
int main(){
    int tt;
    cin>>tt;
    int cs=0;
    while(tt--){
        int n, m;
        cin>>n>>m;
        for(int i=1;i<=n;i++) cin>>a[i];
        build(1,1,n);
        //for(int i=1;i<=4*n;i++) cout<<t[i]<<" "; cout<<endl;
        cout<<"Case "<<++cs<<":"<<endl;
        while(m--){
            int x;
            cin>>x;
            if(x==1){
                int ind;
                cin>>ind;
                ind++;
                update(1,1,n,ind,0);
            }
            else if(x==2){
                int ind,val;
                cin>>ind>>val;
                ind++;
                update(1,1,n,ind,val);
            }
            else{
                int i,j;
                cin>>i>>j;
                i++,j++;
                cout<<query(1,1,n,i,j)<<endl;
            }
        }
    }

}
